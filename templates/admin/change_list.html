{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %}

{% block title %}{% if cl.formset and cl.formset.errors %}{% translate "Error:" %} {% endif %}{{ block.super }}{% endblock %}
{% block extrastyle %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'admin/css/changelists.css' %}">
  {% if cl.formset %}
    <link rel="stylesheet" href="{% static 'admin/css/forms.css' %}">
  {% endif %}
  {% if cl.formset or action_form %}
    <script src="{% url 'admin:jsi18n' %}"></script>
  {% endif %}
  {{ media.css }}
  {% if not actions_on_top and not actions_on_bottom %}
    <style>
      #changelist table thead th:first-child {width: inherit}
    </style>
  {% endif %}
  <style>
    .custom-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        margin: -20px -20px 20px -20px;
        border-radius: 0 0 10px 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .custom-header h1 {
        color: white;
        margin: 0;
        font-size: 24px;
        font-weight: 600;
    }
    .custom-actions {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }
    .custom-btn {
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        font-weight: 600;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
        cursor: pointer;
        font-size: 14px;
    }
    .custom-btn-primary {
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
    }
    .custom-btn-primary:hover {
        background: linear-gradient(135deg, #218838, #1e9e8a);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
    }
    .custom-btn-secondary {
        background: linear-gradient(135deg, #6c757d, #868e96);
        color: white;
    }
    .custom-btn-secondary:hover {
        background: linear-gradient(135deg, #545b62, #6a737b);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
    }
    .custom-btn-warning {
        background: linear-gradient(135deg, #ffc107, #fd7e14);
        color: white;
    }
    .custom-btn-warning:hover {
        background: linear-gradient(135deg, #e0a800, #e36407);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
    }
    .custom-btn-danger {
        background: linear-gradient(135deg, #dc3545, #c82333);
        color: white;
    }
    .custom-btn-danger:hover {
        background: linear-gradient(135deg, #c82333, #a71e2a);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
    }
    .stats-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }
    .stat-card {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        text-align: center;
        border-left: 4px solid #667eea;
    }
    .stat-number {
        font-size: 24px;
        font-weight: bold;
        color: #667eea;
        display: block;
    }
    .stat-label {
        color: #6c757d;
        font-size: 14px;
    }
    /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© */
    .original-title {
        display: none !important;
    }
  </style>
{% endblock %}

{% block extrahead %}
{{ block.super }}
{{ media.js }}
<script src="{% static 'admin/js/filters.js' %}" defer></script>
<script>
    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', function() {
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
        const oldTitles = document.querySelectorAll('h1');
        oldTitles.forEach(title => {
            if (!title.classList.contains('custom-header') && 
                (title.textContent.includes('Ø§Ø®ØªØ±') || 
                 title.textContent.includes('Select') || 
                 title.textContent.includes('Change'))) {
                title.classList.add('original-title');
            }
        });
        
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ breadcrumbs Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
        const breadcrumbs = document.querySelector('.breadcrumbs');
        if (breadcrumbs) {
            breadcrumbs.style.display = 'none';
        }
    });
</script>
{% endblock %}

{% block bodyclass %}{{ block.super }} app-{{ opts.app_label }} model-{{ opts.model_name }} change-list{% endblock %}

{% block breadcrumbs %}
{% comment %}
    ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ breadcrumbs ÙÙŠ Ø§Ù„Ù€ JavaScript
{% endcomment %}
{% endblock %}

{% block coltype %}{% endblock %}

{% block content %}
  <div class="custom-header">
    <h1>ğŸ¯ {{ cl.opts.verbose_name_plural|capfirst }}</h1>
    <p>Ø¥Ø¯Ø§Ø±Ø© ÙˆØ¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</p>
  </div>

  <div id="content-main">
    <!-- Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ© -->
    <div class="custom-actions">
      <a href="{% url cl.opts|admin_urlname:'add' %}" class="custom-btn custom-btn-primary">
        â• {% translate "Add" %} {{ cl.opts.verbose_name }}
      </a>
      <button type="button" class="custom-btn custom-btn-secondary" onclick="exportData()">
        ğŸ“Š {% translate "Export Data" %}
      </button>
      <button type="button" class="custom-btn custom-btn-warning" onclick="bulkActions()">
        ğŸ› ï¸ {% translate "Bulk Actions" %}
      </button>
      <a href="{% url 'admin:index' %}" class="custom-btn custom-btn-secondary">
        ğŸ  {% translate "Dashboard" %}
      </a>
    </div>

    <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
    <div class="stats-cards">
      <div class="stat-card">
        <span class="stat-number">{{ cl.result_count }}</span>
        <span class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</span>
      </div>
      <div class="stat-card">
        <span class="stat-number">{% if cl.result_count %}{{ cl.result_count }}{% else %}0{% endif %}</span>
        <span class="stat-label">Ø³Ø¬Ù„Ø§Øª Ù…ÙØ¹Ù„Ø©</span>
      </div>
      <div class="stat-card">
        <span class="stat-number">0</span>
        <span class="stat-label">Ø³Ø¬Ù„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</span>
      </div>
      <div class="stat-card">
        <span class="stat-number" id="active-count">0</span>
        <span class="stat-label">Ø³Ø¬Ù„Ø§Øª Ù†Ø´Ø·Ø©</span>
      </div>
    </div>

    {% comment %}
    ØªÙ… Ø¥Ø²Ø§Ù„Ø© object-tools Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø± ÙÙŠ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ©
    {% endcomment %}
    
    {% if cl.formset and cl.formset.errors %}
        <p class="errornote">
        {% blocktranslate count counter=cl.formset.total_error_count %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktranslate %}
        </p>
        {{ cl.formset.non_form_errors }}
    {% endif %}
    
    <div class="module{% if cl.has_filters %} filtered{% endif %}" id="changelist">
      <div class="changelist-form-container">
        {% block search %}{% search_form cl %}{% endblock %}
        {% block date_hierarchy %}{% if cl.date_hierarchy %}{% date_hierarchy cl %}{% endif %}{% endblock %}

        <form id="changelist-form" method="post"{% if cl.formset and cl.formset.is_multipart %} enctype="multipart/form-data"{% endif %} novalidate>{% csrf_token %}
        {% if cl.formset %}
          <div>{{ cl.formset.management_form }}</div>
        {% endif %}

        {% block result_list %}
          {% if action_form and actions_on_top and cl.show_admin_actions %}{% admin_actions %}{% endif %}
          {% result_list cl %}
          {% if action_form and actions_on_bottom and cl.show_admin_actions %}{% admin_actions %}{% endif %}
        {% endblock %}
        {% block pagination %}{% pagination cl %}{% endblock %}
        </form>
      </div>
      {% block filters %}
        {% if cl.has_filters %}
          <nav id="changelist-filter" aria-labelledby="changelist-filter-header">
            <h2 id="changelist-filter-header">{% translate 'Filter' %}</h2>
            {% if cl.is_facets_optional or cl.has_active_filters %}<div id="changelist-filter-extra-actions">
              {% if cl.is_facets_optional %}<h3>
                {% if cl.add_facets %}<a href="{{ cl.remove_facet_link }}" class="hidelink">{% translate "Hide counts" %}</a>
                {% else %}<a href="{{ cl.add_facet_link }}" class="viewlink">{% translate "Show counts" %}</a>{% endif %}
              </h3>{% endif %}
              {% if cl.has_active_filters %}<h3>
                <a href="{{ cl.clear_all_filters_qs }}">&#10006; {% translate "Clear all filters" %}</a>
              </h3>{% endif %}
            </div>{% endif %}
            {% for spec in cl.filter_specs %}{% admin_list_filter cl spec %}{% endfor %}
          </nav>
        {% endif %}
      {% endblock %}
    </div>
  </div>

  <script>
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹
    document.addEventListener('DOMContentLoaded', function() {
        // Ø¹Ø¯ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© (Ø§ÙØªØ±Ø¶ ÙˆØ¬ÙˆØ¯ Ø­Ù‚Ù„ is_active)
        const activeRows = document.querySelectorAll('tr[class*="row"]');
        let activeCount = 0;
        
        activeRows.forEach(row => {
            // Ø§ÙØªØ±Ø¶ Ø£Ù† Ø§Ù„ØµÙ Ø§Ù„Ù†Ø´Ø· Ù„ÙŠØ³ Ù„Ù‡ class "deleted" Ø£Ùˆ Ù…Ø´Ø§Ø¨Ù‡
            if (!row.classList.contains('deleted') && !row.style.display.includes('none')) {
                activeCount++;
            }
        });
        
        document.getElementById('active-count').textContent = activeCount;
        
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ø§ÙØªØ±Ø§Ø¶ÙŠ)
        const newCount = document.querySelectorAll('.field-created_at').length;
        document.querySelector('.stat-card:nth-child(3) .stat-number').textContent = newCount;
    });

    function exportData() {
        alert('ğŸ“¤ Ø¬Ø§Ø±ÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
    }
    
    function bulkActions() {
        alert('ğŸ› ï¸ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¬Ø±Ø§Ø¡ Ø¬Ù…Ø§Ø¹ÙŠ');
    }
  </script>
{% endblock %}